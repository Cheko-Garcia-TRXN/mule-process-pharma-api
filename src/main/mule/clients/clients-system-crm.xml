<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:system-crm="http://www.mulesoft.org/schema/mule/system-crm" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/system-crm http://www.mulesoft.org/schema/mule/system-crm/current/mule-system-crm.xsd">
	<system-crm:config name="System_CRM_Config" doc:name="System CRM Config" doc:id="566e51eb-9f8d-4b34-990e-9125945d7ca5" property_host="${client.system.crm.https.host}" property_port="${client.system.crm.https.port}" property_basePath="/api" property_protocol="HTTPS" property_responseTimeout="${client.system.crm.https.response.timeout}" >
		<expiration-policy maxIdleTime="${client.system.crm.https.connection.idle.timeout}" timeUnit="MILLISECONDS" />
	</system-crm:config>
	<sub-flow name="clients-system-crm-get-products" doc:id="bf646ba0-8b91-4d68-9d14-d0bd7eb31f7c" >
		<!-- [STUDIO:"Request"]<http:request method="GET" doc:name="Request" doc:id="0f57e6c1-a37f-4522-ae01-170a85ba6790" config-ref="HTTP_request_system_crm" path="${client.system.crm.https.path.products.post}">
			<http:headers ><![CDATA[#[output application/java
&#45;&#45;-
{
	"client_secret" : Mule::p('secure::client.system.crm.https.client_id'),
	"client_id" : Mule::p('secure::client.system.crm.https.client_secret')
}&#93;&#93;&#93;></http:headers>
		</http:request> [STUDIO] -->
		<system-crm:get-all-products doc:name="get all products request" doc:id="245f7c6a-affd-4608-9087-f7c30d1d69e5" config-ref="System_CRM_Config" client-id="#[p('secure::client.system.crm.https.client_id')]" client-secret="#[p('secure::client.system.crm.https.client_secret')]"/>
	</sub-flow>
	<sub-flow name="clients-system-crm-get-orders" doc:id="82523151-d1e3-4cbc-a4bb-391350d1aaed" >
		<!-- [STUDIO:"Request"]<http:request method="GET" doc:name="Request" doc:id="dd47082c-6ac0-4810-967b-a5a1438d9b74" config-ref="HTTP_request_system_crm" path="${client.system.crm.https.path.orders.post}">
			<http:headers ><![CDATA[#[output application/java
&#45;&#45;-
{
	"client_secret" : Mule::p('secure::client.system.crm.https.client_id'),
	"client_id" : Mule::p('secure::client.system.crm.https.client_secret')
}&#93;&#93;&#93;></http:headers>
			<http:query-params ><![CDATA[#[output application/java
&#45;&#45;-
{
	"certification_date_from" : vars.certification_date_from,
	"certification_date_to" : vars.certification_date_to
}&#93;&#93;&#93;></http:query-params>
		</http:request> [STUDIO] -->
		<system-crm:get-orders-by-last-modified-date doc:name="Get orders by last modified date request" doc:id="6293c035-4dfb-4d97-b7a0-5a4ede9aa54e" config-ref="System_CRM_Config" client-id="#[Mule::p('secure::client.system.crm.https.client_id')]" client-secret="#[Mule::p('secure::client.system.crm.https.client_secret')]" certification-date-from="#[vars.certification_date_from]" certification-date-to="#[vars.certification_date_to]"/>
	</sub-flow>
	<sub-flow name="clients-system-crm-get-remisions-certified-report" doc:id="ab67bf14-0ad8-43c9-aa4b-edc9b0454f1d" >
		<!-- [STUDIO:"Request"]<http:request method="POST" doc:name="Request" doc:id="c5f1027d-62f5-4006-8739-c28fbed244d7" config-ref="HTTP_request_system_crm" path="${client.system.crm.https.path.remisions.certified.report.post}">
			<http:headers ><![CDATA[#[output application/java
&#45;&#45;-
{
	"client_secret" : Mule::p('secure::client.system.crm.https.client_id'),
	"client_id" : Mule::p('secure::client.system.crm.https.client_secret')
}&#93;&#93;&#93;></http:headers>
			<http:query-params ><![CDATA[#[output application/java
&#45;&#45;-
{
	"remision" : vars.remision,
	"certification_date_from" : vars.certification_date_from,
	"certification_date_to" : vars.certification_date_to
}&#93;&#93;&#93;></http:query-params>
		</http:request> [STUDIO] -->
		<system-crm:obtain-remisions-certified doc:name="Obtain Remisions Certified" doc:id="5566ab50-e0dc-4346-b237-188732d3871a" config-ref="System_CRM_Config" client-id="#[p('secure::client.system.crm.https.client_id')]" client-secret="#[p('secure::client.system.crm.https.client_secret')]" no-remision="#[vars.remision]" certification-date-from="#[vars.certification_date_from]" certification-date-to="#[vars.certification_date_to]"/>
	</sub-flow>	
</mule>
